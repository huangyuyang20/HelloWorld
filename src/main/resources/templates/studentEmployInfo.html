
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <meta charset="UTF-8">
    <title>学生信息管理</title>
    <%-- Bootstrap --%>
    <%-- Custom styles for this template --%>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <link rel="stylesheet" href="/assets/css/amazeui.min.css"/>
    <link rel="stylesheet" href="/assets/css/admin.css">
    <link rel="stylesheet" href="/assets/css/app.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">


</head>
<body data-type="generalComponents">
<header class="am-topbar am-topbar-inverse admin-header">
    <div class="am-topbar-brand">
        <a href="javascript:;" class="tpl-logo">
            <img src="/assets/img/logo.png" alt="">
        </a>
    </div>
    <div class="am-icon-list tpl-header-nav-hover-ico am-fl am-margin-right">

    </div>

    <button class="am-topbar-btn am-topbar-toggle am-btn am-btn-sm am-btn-success am-show-sm-only" data-am-collapse="{target: '#topbar-collapse'}"><span class="am-sr-only">导航切换</span> <span class="am-icon-bars"></span></button>

    <div class="am-collapse am-topbar-collapse" id="topbar-collapse">

        <ul class="am-nav am-nav-pills am-topbar-nav am-topbar-right admin-header-list tpl-header-list">
            <li class="am-dropdown" data-am-dropdown data-am-dropdown-toggle>
                <a class="am-dropdown-toggle tpl-header-list-link" onclick="Jump1()">
                    <span class="am-icon-comment-o"></span>学生信息管理
                </a>
            </li>
            <li class="am-dropdown" data-am-dropdown data-am-dropdown-toggle>
                <a class="am-dropdown-toggle tpl-header-list-link" onclick="Jump3()">
                    <span class="am-icon-comment-o"></span>就业管理
                </a>
            </li>
            <li class="am-dropdown" data-am-dropdown data-am-dropdown-toggle>
                <a class="am-dropdown-toggle tpl-header-list-link" onclick="Jump2()">
                    <span class="am-icon-comment-o"></span>入学审核
                </a>
            </li>
            <li class="am-hide-sm-only"><a href="javascript:;" id="admin-fullscreen" class="tpl-header-list-link"><span class="am-icon-arrows-alt"></span> <span class="admin-fullText">开启全屏</span></a></li>

            <li class="am-dropdown" data-am-dropdown data-am-dropdown-toggle>
                <a class="am-dropdown-toggle tpl-header-list-link" href="javascript:;">
                                       <span class="tpl-header-list-user-nick"  sec:authentication="name">
                    </span><span class="tpl-header-list-user-ico"> <img src="../assets/img/user02.png"></span></a>
                <ul class="am-dropdown-content">
                    <li><a href="#"><span class="am-icon-bell-o"></span> 个人信息</a></li>
                    <li><a href="#"><span class="am-icon-cog"></span> 修改密码</a></li>
                    <li><a href="/index"><span class="am-icon-power-off"></span> 退出账户</a></li>
                </ul>
            </li>
            <li><a href="/index" class="tpl-header-list-link"><span class="am-icon-sign-out tpl-header-list-ico-out-size"></span></a></li>
        </ul>
    </div>
</header>

<div class="tpl-page-container tpl-page-header-fixed">


    <div class="tpl-left-nav tpl-left-nav-hover">
        <div class="tpl-left-nav-title">
            友情链接
        </div>
        <div class="tpl-left-nav-list">
            <ul class="tpl-left-nav-menu">
                <li class="tpl-left-nav-item">
                    <a href="/index" class="nav-link active">
                        <i class="am-icon-home"></i>
                        <span>首页</span>
                    </a>
                </li>
                <li class="tpl-left-nav-item">
                    <a href="http://www.scu.edu.cn" class="nav-link tpl-left-nav-link-list">
                        <i class="am-icon-bar-chart"></i>
                        <span>学校官网</span>
                        <i class="tpl-left-nav-content tpl-badge-danger">
                            hot
                        </i>
                    </a>
                </li>
                <li class="tpl-left-nav-item">
                    <a href="http://jwc.scu.edu.cn" class="nav-link tpl-left-nav-link-list">
                        <i class="am-icon-bar-chart"></i>
                        <span>教务处</span>
                        <i class="tpl-left-nav-content tpl-badge-success">
                            10+
                        </i>
                    </a>
                </li>
                <li class="tpl-left-nav-item">
                    <a href="http://xsc.scu.edu.cn" class="nav-link tpl-left-nav-link-list">
                        <i class="am-icon-bar-chart"></i>
                        <span>学工部</span>
                        <i class="tpl-left-nav-content tpl-badge-primary">
                            new
                        </i>
                    </a>
                </li>
                <li class="tpl-left-nav-item">
                    <a href="http://youth.scu.edu.cn" class="nav-link tpl-left-nav-link-list">
                        <i class="am-icon-bar-chart"></i>
                        <span>青春川大</span>
                        <i class="tpl-left-nav-content tpl-badge-success">
                            10+
                        </i>
                    </a>
                </li>
                <li class="tpl-left-nav-item">
                    <a href="http://gs.scu.edu.cn" class="nav-link tpl-left-nav-link-list">
                        <i class="am-icon-bar-chart"></i>
                        <span>研究生网</span>
                        <i class="tpl-left-nav-content tpl-badge-danger">
                            hot
                        </i>
                    </a>
                </li>
                <li class="tpl-left-nav-item">
                    <a href="http://zhjw.scu.edu.cn" class="nav-link tpl-left-nav-link-list">
                        <i class="am-icon-bar-chart"></i>
                        <span>教务系统</span>
                        <i class="tpl-left-nav-content tpl-badge-danger">
                            hot
                        </i>
                    </a>
                </li>
                <li class="tpl-left-nav-item">
                    <a href="http://mail.scu.edu.cn" class="nav-link tpl-left-nav-link-list">
                        <i class="am-icon-bar-chart"></i>
                        <span>邮件系统</span>
                        <i class="tpl-left-nav-content tpl-badge-primary">
                            test
                        </i>
                    </a>
                </li>

                <li class="tpl-left-nav-item">
                    <a href="javascript:;" class="nav-link tpl-left-nav-link-list">
                        <i class="am-icon-wpforms"></i>
                        <span>学院网站</span>
                        <i class="am-icon-angle-right tpl-left-nav-more-ico am-fr am-margin-right"></i>
                    </a>
                    <ul class="tpl-left-nav-sub-menu">
                        <li>
                            <a href="http://cs.scu.edu.cn">
                                <i class="am-icon-angle-right"></i>
                                <span>计算机学院</span>
                                <i class="am-icon-star tpl-left-nav-content-ico am-fr am-margin-right"></i>
                            </a>
                        </li>
                        <li>
                            <a href="http://sw.scu.edu.cn">
                                <i class="am-icon-angle-right"></i>
                                <span>软件学院</span>
                                <i class="am-icon-star tpl-left-nav-content-ico am-fr am-margin-right"></i>
                            </a>
                        </li>
                        <li>
                            <a href="http://math.scu.edu.cn">
                                <i class="am-icon-angle-right"></i>
                                <span>数学学院</span>
                                <i class="am-icon-star tpl-left-nav-content-ico am-fr am-margin-right"></i>
                            </a>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <div class="tpl-content-wrapper">
        <div class="tpl-content-page-title">
            四川大学数字化校园建设(学生就业信息管理模块 管理员)
        </div>

        <ol class="am-breadcrumb">
            <li><a href="/index" class="am-icon-home">首页</a></li>

            <li class="am-active">学生就业信息管理</li>
        </ol>

        <div class="tpl-portlet-components">
            <div class="portlet-title">
                <div class="caption font-green bold">
                    <span class="am-icon-code"></span> 学生就业信息列表
                </div>
                <div class="tpl-portlet-input tpl-fz-ml">
                    <div class="portlet-input input-small input-inline">
                        <div class="input-icon right">
                            <i class="am-icon-search" onclick="jumpEdit('resarch')"></i>
                            <input type="text" id="stuIdFind" class="form-control form-control-solid" placeholder="输入学生id搜索..."> </div>
                    </div>
                </div>


            </div>
            <div class="tpl-block">
                <div class="am-g">
                    <div class="am-u-sm-12">
                        <form class="am-form" onsubmit="return false;">
                            <table class="am-table am-table-striped am-table-hover table-main">
                                <thead>
                                <tr>
                                    <th class="table-id">学生ID</th>
                                    <th class="table-title">学生姓名</th>

                                    <th class="table-id">邮箱</th>
                                    <th class="table-author am-hide-sm-only">专业</th>
                                    <th class="table-date am-hide-sm-only">电话</th>
                                    <th class="table-date am-hide-sm-only">毕业去向</th>
                                    <th class="table-set">操作</th>
                                </tr>
                                </thead>
                                <tbody id = "scholarManage">

                                </tbody>
                            </table>
                            <hr>

                        </form>
                    </div>

                </div>
            </div>
            <div class="tpl-alert"></div>
        </div>


    </div>
</div>
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop=”static”>
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title" id="myModalLabel">学生就业信息</h4>
            </div>
            <div class="modal-body" id="editInfo"></div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal" onclick="ClearMessage()">关闭</button>
                <button type="button" class="btn btn-primary" onclick="submitEdit()">提交更改</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
</body>

<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/amazeui.min.js"></script>
<script src="/assets/js/app.js"></script>
<script src="/js/dataTransfer.js" type="text/javascript" language="javascript" charset="utf-8"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<script>
    var token = $("meta[name='_csrf']").attr("content");
    var header = $("meta[name='_csrf_header']").attr("content");

    //如果需要 用于修改
    //请求ajax 对于返回数据采用 append html加入 参考上面的html
    var token = $("meta[name='_csrf']").attr("content");
    var header = $("meta[name='_csrf_header']").attr("content");
    var appInfo = sessionStorage.getItem('appInfo');
    appInfo= JSON.parse(appInfo);
    //如果需要 用于修改
    //请求ajax 对于返回数据采用 append html加入 参考上面的html
    $.ajax({
        type: 'get',
        url: '/studentManage/getAllStudent',
        dataType: 'json',
        contentType: "application/json;charset=UTF-8",

        async : false,
        beforeSend: function(request) {
            request.setRequestHeader(header, token); // 添加  CSRF Token
        },
        success: function (data) {
            console.log(data);
            for (var i = 0; i < data.length; i++){
                var  str = "<tr>\n" +
                    "        <td>"+data[i].stuId+"</td>\n" +
                    "        <td>"+data[i].stuName+"</td>\n" +
                    "        <td>"+data[i].stuEmail+"</td>\n" +
                    "        <td >"+data[i].stuMajor+"</td>\n" +
                    "        <td >"+data[i].stuPhone+"</td>\n" +
                    "        <td >"+data[i].employmentInformation+"</td>\n" +

                    "        <td>\n" +
                    "        <div class=\"am-btn-toolbar\">\n" +
                    "        <div id =\"schoID\" class=\"am-btn-group am-btn-group-xs\">\n" +
                    "        <button onclick=\"jumpEdit("+"'"+data[i].stuId+"'"+")\" class=\"am-btn am-btn-default am-btn-xs am-text-secondary\"><span class=\"am-icon-pencil-square-o\"></span> 添加就业信息</button>\n" +
                    "    </div>\n" +
                    "    </div>\n" +
                    "    </td>\n" +
                    "    </tr>"
                $('#scholarManage').append(str);

            }

        },
        error: function(data){
            console.log("失败");
        }
    });

</script>
<script>

    var stuid = "";
    function jumpEdit(obj1){
        if (obj1==="resarch")
        {
            obj1= $('#stuIdFind')[0].value
        }

        $('#myModal').modal({backdrop:'static',keyboard: false});
        var token = $("meta[name='_csrf']").attr("content");
        var header = $("meta[name='_csrf_header']").attr("content");

        //如果需要 用于修改
        //请求ajax 对于返回数据采用 append html加入 参考上面的html
        var token = $("meta[name='_csrf']").attr("content");
        var header = $("meta[name='_csrf_header']").attr("content");
        var appInfo = sessionStorage.getItem('appInfo');
        appInfo= JSON.parse(appInfo);
        //如果需要 用于修改
        //请求ajax 对于返回数据采用 append html加入 参考上面的html
        $.ajax({
            type: 'post',
            url: '/studentManage/queryStudentById',
            dataType: 'json',
            contentType: "application/json;charset=UTF-8",
            data:JSON.stringify({
                stuId:obj1.toString()
            }),

            async : false,
            beforeSend: function(request) {
                request.setRequestHeader(header, token); // 添加  CSRF Token
            },
            success: function (data) {
                stuid = data.stuId;
                console.log(data);
                var  str =
                    "<table>"+
                    "        <tr><td width='50%'>学生ID     "+"</td><td>"+data.stuId+"</td></tr>\n" +
                    "        <tr><td>学生姓名     "+"</td><td>"+data.stuName+"</td></tr>\n" +
                    "        <tr><td>电话号码         "+"</td><td><input type='text' id='stuPhone' value='"+data.stuPhone+"'></td></tr>\n" +
                    "        <tr><td>邮箱         "+"</td><td><input type='text' id='stuEmail' value='"+data.stuEmail+"'><td></tr>\n"+"       " +
                    "        <tr><td>就业信息         "+"</td><td><input type='text' id='employmentInformation' value='"+data.employmentInformation+"'></td></tr>\n" ;


                $('#editInfo').append(str);
            },
            error: function(data){
                console.log("失败");
            }
        });
    }
    submitEdit = function () {
        var stuPhone = $('#stuPhone')[0].value;
        var stuEmail = $('#stuEmail')[0].value;
        var employmentInformation=$('#employmentInformation')[0].value;
        datas = {
            stuId:stuid,
            stuPhone:stuPhone,
            stuEmail:stuEmail,
            employmentInformation:employmentInformation

        };
        $.ajax({
            type: 'post',
            url: '/studentManage/updateStudentInformation',
            contentType: "application/json;charset=UTF-8",
            data:JSON.stringify(datas),

            async : false,
            beforeSend: function(request) {
                request.setRequestHeader(header, token); // 添加  CSRF Token
            },
            success: function (data) {
                alert(data);
                window.location.href="/studentEmployInformation";
            },
            error: function(data){
                console.log("失败");
            }
        });


    }
</script>
<script>
    ClearMessage = function () {
        $('#editInfo').html("");
    };
</script>
<script>
    Jump1 = function () {
        window.location.href="/studentInfo"//学生管理页面
    };
    Jump2 = function () {
        window.location.href="/check3"//学生入学申请审核
    };
    Jump3 = function () {
        window.location.href="/studentEmployInformation"//学生就业信息
    }
</script>

</html>

